<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Type 1 Diabetes Calculator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="manifest" href="manifest.webmanifest">
  <link rel="stylesheet" href="style.css?v=11">
</head>
<body>
  <header class="site-header">
    <h1>Type 1 Diabetes Calculator</h1>
    <p>Enter nutrition label values per serving, how much is eaten, plus BSL, IOB and context.</p>
  </header>

  <main>
    <!-- Tabs -->
    <div class="tabs">
      <button id="tab-current" class="tab active" type="button">Current meal</button>
      <button id="tab-history" class="tab" type="button">History</button>
    </div>

    <!-- Current meal screen -->
    <section id="screen-current" class="screen">
      <!-- Profile card -->
      <section class="card profile-card">
        <h2>Profile</h2>

        <label for="profileName">Profile name</label>
        <input id="profileName" type="text" placeholder="e.g., Kai">

        <div class="profile-context grid2">
          <div class="field-group">
            <label for="bsl">Current BSL (mg/dL)</label>
            <input id="bsl" type="number" min="0" step="1">
          </div>
          <div class="field-group">
            <label for="iob">Insulin on board (u)</label>
            <input id="iob" type="number" min="0" step="0.05">
          </div>
        </div>
      </section>

      <!-- Layout: Step 1 and Step 2 side by side on desktop -->
      <div class="grid2 top-grid">
        <!-- Step 1 card -->
        <section class="card">
          <h2>STEP 1: Food label per serving</h2>

          <label for="foodName">Food name</label>
          <input id="foodName" type="text" list="foodNames" placeholder="e.g., Barilla Protein+ Pasta">

          <label for="mealType">Meal type</label>
          <select id="mealType">
            <option value="Home Meal">Home Meal</option>
            <option value="Fast Food">Fast Food</option>
            <option value="Restaurant">Restaurant</option>
            <option value="Other">Other</option>
          </select>

          <label for="servingSize">Serving size (g or mL)</label>
          <input id="servingSize" type="number" min="0" step="0.1">

          <label for="servingPieces">Serving equals how many pieces (optional)</label>
          <input id="servingPieces" type="number" min="0" step="0.1" placeholder="e.g., 5 for 5 crackers">

          <label for="calories">Calories</label>
          <input id="calories" type="number" min="0" step="1">

          <label for="fat">Fat (g)</label>
          <input id="fat" type="number" min="0" step="0.1">

          <label for="sodium">Sodium (mg)</label>
          <input id="sodium" type="number" min="0" step="1">

          <label for="carbs">Carbs (g)</label>
          <input id="carbs" type="number" min="0" step="0.1">

          <label for="fiber">Fiber (g)</label>
          <input id="fiber" type="number" min="0" step="0.1">

          <label for="sugar">Sugar (g)</label>
          <input id="sugar" type="number" min="0" step="0.1">

          <label for="protein">Protein (g)</label>
          <input id="protein" type="number" min="0" step="0.1">

          <datalist id="foodNames">
            <!-- Your common foods can go here if you like -->
          </datalist>
        </section>

        <!-- Step 2 and Results -->
        <section class="card">
          <h2>STEP 2: Enter consumed information</h2>

          <label for="amountEaten">Having, amount eaten (g or mL)</label>
          <input id="amountEaten" type="number" min="0" step="0.1">

          <label for="piecesEaten">or pieces (optional)</label>
          <input id="piecesEaten" type="number" min="0" step="0.1" placeholder="e.g., 8 crackers">

          <button id="addItemBtn" type="button">Click to Add</button>

          <h3>Food item summary</h3>
          <p class="hint">Quick view of carbs, fat, and protein for each logged item.</p>

          <div class="table-wrapper small-table">
            <table>
              <thead>
                <tr>
                  <th>Item Name</th>
                  <th>Carbs</th>
                  <th>Fat</th>
                  <th>Protein</th>
                </tr>
              </thead>
              <tbody id="summaryTableBody"></tbody>
            </table>
          </div>

          <h3>Results</h3>
          <div class="results-box">
            <p>Total carbs: <span id="resultTotalCarbs">0.0</span> g</p>
            <p>Total fat: <span id="resultTotalFat">0.0</span> g</p>
            <p>Total protein: <span id="resultTotalProtein">0.0</span> g</p>
            <hr>
            <p>Pre-bolus: <span id="resultPrebolus">--</span></p>
            <p>Split: <span id="resultSplit">--</span></p>
            <p>Food type: <span id="resultFoodType">--</span></p>
            <p>Reason: <span id="resultReason">--</span></p>
          </div>

          <button id="saveToHistoryBtn" type="button" class="secondary">
            Save to history, clears current
          </button>
        </section>
      </div>

      <!-- Logged foods -->
      <section class="card">
        <h2>Logged food items</h2>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Item Name</th>
                <th>Calories</th>
                <th>Fat</th>
                <th>Sodium</th>
                <th>Carbs</th>
                <th>Fiber</th>
                <th>Sugar</th>
                <th>Protein</th>
              </tr>
            </thead>
            <tbody id="loggedItemsBody"></tbody>
          </table>
        </div>
      </section>
    </section>

    <!-- History screen -->
    <section id="screen-history" class="screen hidden">
      <section class="card">
        <h2>Saved food templates (per serving)</h2>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Name</th>
                <th>Serving</th>
                <th>Cal</th>
                <th>Fat</th>
                <th>Na</th>
                <th>Carbs</th>
                <th>Fiber</th>
                <th>Sugar</th>
                <th>Protein</th>
              </tr>
            </thead>
            <tbody id="historyTableBody"></tbody>
          </table>
        </div>
        <button id="clearHistoryBtn" type="button" class="danger">Clear history</button>
      </section>
    </section>
  </main>

  <script src="app.js?v=11" defer></script>
</body>
</html>
